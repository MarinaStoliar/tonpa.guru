<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <meta name="author" content="Maxim Sokhatsky" />
    <title>2020-10-10</title>
    <link rel="stylesheet" href="https://n2o.dev/blank.css" />
    <link rel="stylesheet" href="https://tonpa.guru/journal.css" />
</head>
<body>
<nav>
    <a href='../../index.html'>5HT</a>
    <a href='../index.html'>TOP</a>
    <a href='#'>2020-10-10</a>
</nav>
<main>
    <section>

       <h3>FPGA археология</h3>

        <p>Это статья об FPGA репликах ретро-комптьютерав 70-х и 80-х годов 20 века. Исследование
           архаичных систем называется компьютерной археологией.
           Главная проблема коллекционирования бытовой электроники того времени
           &mdash; это ветхость оборудования. Конденсаторы вздуваются,
           плывут древние LCD дисплеи, окисляются контакты, выходит из строя практически всё.
           Софтверные эмулятры (обычно строящиеся на базе Raspberry Pie) не
           достаточным образом вдохновляют коллекционеров, хочется владеть
           полной репликой древнего микропроцессора, пускай даже в VHDL виде. Поэтому
           заслуженную популярность взыскали проекты по воссозданию SoC (полной реплики
           не только процессора, но и его периферии, совместимой с современными мониторами,
           клавиатурами и мышами) для FPGA процессоров (Altera, Xilinx, Intel) которые реализуют
           популярные игровые платформы демосцены прошлого.</p>

        <p>В качестве примера, какие процессоры входят в мои сферу интересов,
           как коллекционера, я бы привел следующие платформы: Apple II/ПРАВЕЦ-8, Sega, NES,
           Atari 2600/800XL/ST, MSX2+/КУВТ2, C64, ZX, 8085, HC08, HC016, PDP-11/БК-0010. Здесь же,
           в статье хочу расскать об одном испанском магазинчике древних реплик на FPGA,
           и других проектах, которые я бы рекомендовал как направления или продукты,
           для которых существует много софта, и даже некоторые актуальные проекты энтузиастов.
           Я прощупал немного &mdash; олды еще не умерли и паяют все для детей, чтобы, во-первых,
           те имели возможность учить электронику по отцовским лекалам, а во-вторых,
           получали замечательный образовательный инструмент со своей
           минималистичной средой разработки для 8-битных и 16-битных процессоров,
           который покрывает максимально количество платформ для экспериментов.
           Рекомендую такой практический курс по электронике украинских для школ, 9-11 классов.
           Просто на первом курсе уже пора напрямую управлять NVMe контроллером из юзерлэнда,
           поэтому можно было бы и с 5-го начать, лучше с этим не затягивать.</p>

        <p>Итак, я хочу рассказать о моей коллекции FPGA реплик ретро-компьютеров: 32-битный Atari Falcon,
           8-битный Commodore C64, 16-битный SEGA Genesis, 16-битный DEC PDP-11/70, MSX-компьютер Sony HB-F1XV HitBit MSX2+,
           легендарный Sinclair Research ZX Spectrum 48K+ (в порядке убывания цены);
           находящихся в открытом доступе для прошивки на FPGA чипы, для которых существую
           платы, которые можно купить и заказать. Тиражи коллекционные,
           как и весь ретро-компьютинг. Воссоздание этой коллекции вам обойдется в 1000 евро.</p>

       <h4>ZX Spectrum 48K+ на ZX UNO XL</h4>

        <p>ZX это настоящий народный простой комптьютер, который каждых мог спаять самостоятельно,
           его схемы ходили в журналах, в отличие от Японии, Испании, где превалировали более
           мажорные MSX версии с графическим видеосопроцессором VDP, ZX был распотранен в остальной Европе.
           Это самый простой компьютер, приблизительно уровня Apple II. Даже Commodore C64/6502 считалась
           продвинутой мультмедиа платформой, в отличии от более народной ZX/Z80. Этот процессор настольно народный,
           что ставился долгое время еще в клавиатуры, калькуляторы, телефоны, и ставится до сих пор.
           Аналоги по номенклатуре Intel &mdash; это 8080, 8085.</p>

        <figure><img width=600 src="https://oldcraporg.files.wordpress.com/2017/11/fullsizeoutput_119b.jpeg?w=1000&h="></figure>

         <p>Что сказать, любителям спартанской платформы ZX повезло, у них существует культовая FPGA плата <a href="https://www.8bits4ever.net/product-page/zx-uno-xl">ZX UNO XL (Issue 4)</a>
            на Xilinx Spartan XC6SLX9 стоимостью всего 100 евро, которая кроме самой платформы ZX Spectrum 48K поддерживает также
            Sam Coupe, Jupiter ACE, Apple II, VIC 20, Sega Master System, NES, Atari 800XL, MSX1, C64 и еще парочку.
            Такой богатый набор эмулируемых платформ ставит эту плату в топ обзора. Более того эта плата подходит
            в оригинальные корпуса ZX Spectrum 48K &mdash; я думаю это максимальный подарок.</p>

        <figure><img width=600 src="img/zx-uno-xl.png"></figure>

       <h4>Sony HB-F1XV MSX2+ на SX-1</h4>

        <p>Первые MSX Yamaha я увидел в Каменце-Подольском, в педагогическом университете.
           В городе был завод Электроника всесоюзного значения, поэтому дети работавших там
           инженеров интересовались компьютерами. В городе были Sony и КУВТ2 версии MSX.
           Были компьютерные клубы, во дворе у двоих были самособраные ZX спектрумы, у меня был Atari 800XE (7-й класс),
           в клубах были корветы с сервером на БК. В школе учителя писали самопалтные сетевые протоколы.
           Все клоны геймбоев можно было купить чуть ли не в магазине где продавали спининги.
           Про архитектуру MSX мне впервые рассказали в 9-м классе, когда у меня уже был 486.
           С 4-го класса у нас прямо домашнем классе стоял ряд ПРАВЕЦ-8, а начиная с 5-го был
           допуск к классу IBM PC/AT 286 (В основном меня интересовали F1, Prince of Persia, LHX, Turbo Pascal 5.5).</p>

           <figure><img width=600 src="img/MSX2+.jpg"></figure>

        <p>ZX спектрумские игрушки не были такие продвинутые, как MSX
           из-за наличия аппаратного графического сопроцессора на платформе MSX, что
           превращало его в реальную двухпроцессорную консоль. Графический процессор VDP
           умел аппаратный Брезенхем, бит-блиттинг, вертикальные и горизонтальные копи и сканы, и другие штуки.
           MSX &mdash; это один из японских стандартов на компьютеры, такой как PC,
           которым стал IBM PC/XT или стандарт на ОС реального времени TRON.
           Yamaha, Panasonic, Sony, Philips, все это на eBay стоит от $500.
           Konami Metal Gear Solid первый был написан для MSX. Не знаю, что делали игровые
           консоли КУВТ2 в университетах, но именно там мой учитель программирования
           учился писать игрушки, так как в Microsoft BASIC-MSX, который по стандарту был прошит в каждый ROM,
           есть механизм колизии спрайтов и апаратный битблитинг и управление спрайтами. Писать игрушки было проще.
           Моя любимая игра и на Atari и на MSX и на Z80 &mdash; это <a href="http://tv-games.ru/wiki/Games/MontezumasRevenge.html">Montezuma's
           Revenge</a>, доступна в эмуляторе <a href="https://webmsx.org">webmsx.org</a>.</p>

       <figure><figcaption>Команды Yamaha VDP-V9938</figcaption><table cellspacing=10>
       <thead>
       <th>Команда</th><th>Описание</th><th>Регистры</th>
       </thead>
       <tbody>
       <tr><td>HMMC</td><td>Fill VRAM From CPU</td><td>36-46</td></tr>
       <tr><td>YMMM</td><td>Fast Copy (Y axis)</td><td>34-39,42-26</td></tr>
       <tr><td>HMMM</td><td>Fast Copy</td><td>32-46</td></tr>
       <tr><td>HMMV</td><td>Fill</td><td>36-46</td></tr>
       <tr><td>LMMC</td><td>Logical Fill VRAM From CPU</td><td>36-46</td></tr>
       <tr><td>LMCM</td><td>Logical transfer data to CPU</td><td>32-35,40-46</td></tr>
       <tr><td>LMMM</td><td>Logical Vram to VRAM</td><td>32-46</td></tr>
       <tr><td>LMMV</td><td>Logical Fill</td><td>36-46</td></tr>
       <tr><td>LINE</td><td>Line</td><td>36-46</td></tr>
       <tr><td>SRCH</td><td>Search (X axis)</td><td>32-36,44-46</td></tr>
       <tr><td>PSET</td><td>Pset</td><td>36-39,44-46</td></tr>
       <tr><td>POINT</td><td>Read Point</td><td>32-36,44-46</td></tr>
       <tr><td>STOP</td><td>Async Cancel</td><td>46</td></tr>
       </tbody></table></figure>

       <figure><figcaption>Формат команды VDP-V9938</figcaption><table cellspacing=10>
       <thead>
       <th>CMD</th><th>ARG</th><th>COLOR</th><th>NUM-Y</th><th>NUM-X</th><th>DST-Y</th><th>DST-X</th><th>SRC-Y</th><th>SRC-X</th>
       </thead>
       <tbody>
       <tr><td>46</td><td>45</td><td>44</td><td>42-43</td><td>40-41</td><td>38-39</td><td>36-37</td><td>34-35</td><td>32-33</td></tr>
       </tbody></table></figure>

        <p>С 2000 года один немец разрабатывает операционную систему <a href="http://symbos.de/facts.htm">SymbOS</a> для всех 8-битных платформ,
           в том числе понятно и для MSX, заметьте, что начал он это после смерти пллатформы и делает вроде как до сих пор.
           Если сравнивать SymbOS с Atari TOS, DeskView, Windows 1 или даже с Palm, то вполне ниче, есть WGET, NETSTAT!
           Все наркоманы, которые до сих пор на этом пишут, понятное дело живут в
           Нидерландах <a href="http://map.grauw.nl/articles/">http://map.grauw.nl/articles/</a>.
           ОС можно прямо сейчас запустить в эмуляторе WebMSX по прямой ссылке <a href="https://webmsx.org/symbos/">https://webmsx.org/symbos/</a>.
           Small Device C Compiler прекрасно можно использовать для создания ОС, рантаймов и своих библиотек для MSX/Z80,
           но многие пишут на чистом ассемблере, которых тоже есть несколько. Под эту платформу существует dBase II,
           Turbo Pascal 3.0, CP/M, и несколько DOS-ов и файловых менеджеров. В качестве единственного ресурса
           по программированию ретро-процессоров я рекомендую <a href="https://www.assemblytutorial.com/">assemblytutorial.com</a>.</p>

        <p>В качестве FPGA реплики MSX я выбрал себе материнскую плату <a href="https://www.8bits4ever.net/product-page/SX-1">SX-1</a>
           формата Mini-ITX с FPGA чипом Altera,
           которую производят испанские ребята из 8bit4ever. Работает с PS/2 и USB клавами, SD, картриджи,
           VHD фирмвари опен соурсные. Стоимость 130 евро.</p>

           <figure><img width=600 src="img/sx-1.png"></figure>

           <figure><img width=600 src="img/SX1.png"></figure>

       <h4>DEC PDP-11/70 на Arty A7</h4>

        <p>К сожалению бренда, который бы продвигал культовый PDP-11/70 нет. Делают какие-то дети игрушки на Raspberry Pie,
           но как мы уже отметили, полного удовлетворения такая система не приносит. Поэтому в даном случае
           мы будем рассматривать плату <a href="https://reference.digilentinc.com/reference/programmable-logic/arty-a7/start">Digilent Arty A7</a> на базе FPGA процессора XC7A35 ($130) или XC7A100 ($250), который
           совместим с опен-соурсной VHDL версией PDP-11/70 <a href="https://github.com/wfjm/w11">github.com/wfjm/w11</a>.
           VHDL реализует почти всю периферию (кроме FPU) &mdash; это позволяет плате запускать первые UNIX: System V и 2.11BSD,
           а также оригинальные операционные системы DEC: RT-11 и RSX-11M. Для этих систем были написаны первые компиляторы С,
           и колоночная БД MUMPS, которая получила ISO стандартизацию. Существовали советские клоны PDP-11 БК-0010,
           клон RT-11 ОС ДЕМОС и клон MUMPS система ДИАМС.</p>

        <figure><img width=600 src="https://saccade.com/writing/projects/PDP11/PanelInCase_Side.jpg"></figure>

        <p>Не стоит думать, что наличие UNIX поможет развернуться, это не современная Ubuntu, в 16-битной системе
           окружение будет спартанским и напоминать органичения 8-битных систем. Зато увидите как олды работали.</p>

        <figure><img width=600 src="https://reference.digilentinc.com/_media/reference/programmable-logic/arty/arty-0.png"></figure>

        <p>Для любителей минимализма существует PDP-11/70 на Intel Cyclone:</p>

        <figure><img width=600 src="https://pdp2011.sytse.net/wordpress/wp-content/uploads/2020/04/D85_6251.jpg"></figure>

       <h4>SEGA Genesis на Mega Sg</h4>

         <p>Бедная SEGA пережила несколько фейлов перед ставшими легендарными SEGA MegaDrive/Genesis,
            которые воплощены в FPGA компанией <a href="https://analogue.co">Analogue</a>. Так в 1983 году SEGA вышла с SG-1000, в тот же
            день, что и гораздо более мощная NES (Mario, Donkey Kong). В 1986 году SEGA выпустила
            Master System, в то время как у Nintendo был уже Super Mario. В итоге SEGA решила выпустить Genesis
            полностью на 16 битной платформе: память, процессор, видео. На Genesis были такие игрушки
            как Mortal Kombat (1992), Sonic The Hedgehog (1991), Super Monaco GP (1991), Street Figher (1992), Dune: The Battle For Arrakis (1994),
            Lemmings (1992), Flashback: The Quest for Identity (1993), Virtua Racing (1994). В 1994 SEGA удалось
            сравнять продажи с Nintendo. SEGA Dreamcast на SH-4 была третим и последним фейлом SEGA.
            </p>

        <figure><img width=600 src="https://images.analogue.co/6-store/store-megasg-jpn.jpg?auto=format&w=1466&s=239cf54e6488ebab35ab016dc8c69cd8"></figure>

       <h4>Commodore C64 на Mega65</h4>

         <p>C65 &mdash; это обновленая версия Commodore 64, которая появилась на закате и не успела выйти на рынок.
            <a href="">Museum of Electronic Games & Art</a> собрал достаточное количество средств и уже <a href="https://shop.trenz-electronic.de/en/Products/MEGA65/">доступны заказы</a> на дорогие ($1K)
            наборы для разработчиков (DevKit) воссоздания в FPGA не только C64, но и невыпущеного C65.
            В скором времени верится в ожидание запуска потребительского продукта.
            Документация в TeX, хорошо документована структура VHDL модели &mdash; <a href="https://github.com/mega65/">все на GitHub</a>, отличный
            сайт &mdash; <a href="https://mega65.org">mega65.org</a>. Сама платформа MEGA65 предполагает
            в дальнейшем поддержку ATARI ST и AMIGA.</p>

        <figure><img width=600 src="https://mega65.org/assets/images/portfolio/grid-portfolio2.jpg"></figure>

       <h4>Atari Falcon на FireBee</h4>

        <p>Классические 8-битные Atari были построены на процессоре MOS 6502, том же, что и Commodore 64,
           Apple II и ее болгарский клон ПРАВЕЦ-8. Атари воевала в то время на рынке с Commodore, который поставлял чипы для калькуляторов,
           и с 1981 по 1983 сборсила цену на 800 серию почти в 9 раз. В 1985 Atari перешла на 32-битные
           процессоры Motorola 68K и платформу Atari ST. Atari Falcon &mdash; это апогей этой платформы,
           вополщенный в <a href="http://acp.atari.org/about.html">Atari FireBee</a> на базе процессороа Motorola Coldfire 264MHz.
           Хотя центральный процессор не эмулируется, на плате расположен FPGA Altera Cyclone
           с помощью которого эмулируется оригинальная периферия Atari.

           <figure><img width=600 src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b9/Atari_Falcon_030_%28%D0%BE%D0%B1%D1%89%D0%B8%D0%B9_%D0%B2%D0%B8%D0%B4%29_%28crop_tweak%29.jpg/1920px-Atari_Falcon_030_%28%D0%BE%D0%B1%D1%89%D0%B8%D0%B9_%D0%B2%D0%B8%D0%B4%29_%28crop_tweak%29.jpg"></figure>

        <p>FPGA Плата <a href="http://firebee.org">FireBee</a> (560 евро) поддерживает почти все ОС которые существовали для Atari ST и еще своих докидывает:
           MultiTOS, MagiC, EmuTOS, Atari TOS, Geneva; а также графические среды: GEM, XaAES, FreeMiNT.
           </p>

           <figure><img width=600 src="http://acp.atari.org/images/proto_dec09.jpg"></figure>

           <figure><img width=600 src="http://acp.atari.org/images/1680Asmall.jpg"></figure>

    </section>
</main>
<footer>Namdak Tonpa <span class="heart">&nbsp;❤&nbsp;</span> 2009—2021</footer>
</body>
</html>
